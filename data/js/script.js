(()=>{Handlebars.registerHelper("splitText",function(e){if(e.includes("/")){var t=e.split("/").map(r=>'<div class="flex-items">'+r+"</div>").join("");return'<div class="splitText">'+t+"</div>"}return(e.length==0||e===" ")&&(e="&nbsp;&nbsp;"),'<div class="digit">'+e+"</div>"});Handlebars.registerHelper("ifEquals",function(e,t,r){return e==t?r.fn(this):r.inverse(this)});var i=["Block Height","Moscow Time","Ticker","Time","Halving countdown"];getBcStatus=()=>{fetch("/api/status",{method:"get"}).then(e=>e.json()).then(e=>{var t=document.getElementById("entry-template").innerHTML,r=Handlebars.compile(t),n={currentScreen:e.currentScreen,rendered:e.rendered,data:e.data,screens:i,ledStatus:e.ledStatus?e.ledStatus.map(o=>o.toString(16)):[]};document.getElementById("output").innerHTML=r(n)}).catch(e=>{})};interval=setInterval(getBcStatus,2500);getBcStatus();fetch("/api/settings",{method:"get"}).then(e=>e.json()).then(e=>{var t="0x"+e.fgColor.toString(16).toUpperCase();e.epdColors==2&&(document.getElementById("fgColor").querySelector('[value="0xF800"]').remove(),document.getElementById("bgColor").querySelector('[value="0xF800"]').remove()),document.getElementById("output").classList.add("fg-"+e.fgColor.toString(16)),document.getElementById("output").classList.add("bg-"+e.bgColor.toString(16)),document.getElementById("fgColor").value=t,document.getElementById("bgColor").value="0x"+e.bgColor.toString(16).toUpperCase(),e.ledFlashOnUpdate&&(document.getElementById("ledFlashOnUpdate").checked=!0),e.useBitcoinNode&&(document.getElementById("useBitcoinNode").checked=!0);let r=["rpcHost","rpcPort","rpcUser","tzOffset"];for(let l of r)document.getElementById(l).value=e[l];document.getElementById("timePerScreen").value=e.timerSeconds/60,document.getElementById("ledBrightness").value=e.ledBrightness;var n=document.getElementById("screens-template").innerHTML,o=Handlebars.compile(n),u={screens:e.screens};document.getElementById("outputScreens").innerHTML=o(u)}).catch(e=>{console.log("error",e)});var c=document.querySelector("#settingsForm");c.onsubmit=e=>{var t=new FormData(c);return fetch("/api/settings",{body:t,method:"post"}).then(()=>{console.log("Submitted")}),!1};var d=document.querySelector("#ledsForm");d.onsubmit=e=>{var t=new FormData(d);return fetch("/api/lights/"+encodeURIComponent(t.get("pickedColor").substring(1)),{method:"get"}),!1};turnOffLedsBtn.onclick=e=>(fetch("/api/lights/off",{method:"get"}),!1);var s=document.getElementById("getTzOffsetBtn");s&&(s.onclick=e=>(document.getElementById("tzOffset").value=new Date(new Date().getFullYear(),0,1).getTimezoneOffset()*-1,!1));var m=document.querySelector("#customTextForm");m.onsubmit=e=>{var t=new FormData(m);return fetch("/api/show/text/"+encodeURIComponent(t.get("customText")),{method:"get"}).then(r=>r.json()).catch(r=>{}),!1};changeScreen=e=>{fetch("/api/show/screen/"+encodeURIComponent(e),{method:"get"}).then(t=>t.json()).catch(t=>{})};})();
